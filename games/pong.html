<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PONG - Retro Play (2 Player)</title>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
    }
    body {
      background: #000;
      color: #fff;
      font-family: 'Courier New', monospace;
      width: 100vw;
      height: 100vh;
      box-sizing: border-box;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }
    .container {
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      margin: auto;
      z-index: 1;
    }
    .hud {
      font-size: 32px;
      color: #fff;
      font-family: 'Courier New', monospace;
      margin-bottom: 40px;
      text-align: center;
      letter-spacing: 2px;
      border: 2px solid #fff;
      background: #111;
      padding: 8px 24px;
      border-radius: 4px;
      width: 340px;
      box-sizing: border-box;
    }
    canvas {
      background: #000;
      border: 4px solid #fff;
      display: block;
      image-rendering: pixelated;
      position: relative;
      z-index: 2;
      margin: 0 auto;
      box-sizing: border-box;
    }
    /* More visible scanlines (thicker, whiter) */
    .scanlines {
      pointer-events: none;
      position: fixed;
      left: 0; 
      top: 0;
      width: 100vw; 
      height: 100vh;
      background: repeating-linear-gradient(
        to bottom,
        rgba(255,255,255,0.18) 0px,
        rgba(255,255,255,0.18) 3px,
        transparent 7px,
        transparent 13px
      );
      z-index: 0;
    }
    .instructions {
      position: fixed;
      top: 80%;
        right: 100px;
      transform: translateY(-50%);
      background: #111;
      border: 2px solid #fff;
      padding: 12px 18px;
      color: #fff;
      font-family: 'Courier New', monospace;
      font-size: 16px;
      z-index: 10;
      line-height: 1.6;
      letter-spacing: 1px;
      text-align: left;
      box-sizing: border-box;
      min-width: 160px;
    }
    /* Game Over Modal Styles */
    .modal-overlay {
      display: none;
      position: fixed;
      left: 0;
      top: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0,0,0,0.7);
      z-index: 9999;
      justify-content: center;
      align-items: center;
    }
    .modal-box {
      background: #111;
      border: 3px solid #fff;
      color: #fff;
      font-family: 'Courier New', monospace;
      font-size: 22px;
      padding: 32px 32px 24px 32px;
      border-radius: 8px;
      text-align: center;
      box-shadow: 0 0 16px #222;
      min-width: 320px;
      z-index: 10000;
      display: flex;
      flex-direction: column;
      gap: 24px;
    }
    .modal-buttons {
      display: flex;
      flex-direction: row;
      justify-content: center;
      gap: 28px;
    }
    .modal-btn {
      background: #000;
      color: #fff;
      border: 2px solid #fff;
      font-family: 'Courier New', monospace;
      font-size: 18px;
      padding: 8px 36px;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.15s, color 0.15s;
    }
    .modal-btn:hover {
      background: #fff;
      color: #111;
    }
    @media (max-width: 1200px) {
      .instructions {
        position: static;
        top: auto;
        right: auto;
        transform: none;
        margin-top: 16px;
      }
      .container {
        margin-bottom: 16px;
      }
    }
  </style>
</head>
<body>
  <div class="scanlines"></div>
  <div class="container">
    <div class="hud" id="hud">
      RETRO PONG <br>
      <span id="score">0 &nbsp; | &nbsp; 0</span>
    </div>
    <canvas id="pong" width="800" height="500"></canvas>
  </div>
  <div class="instructions">
    <strong>Instructions:</strong><br>
    Player 1: W / S<br>
    Player 2: ↑ / ↓<br>
    First to 10 wins!
  </div>
  <!-- Game Over Modal -->
  <div class="modal-overlay" id="modalOverlay">
    <div class="modal-box">
      <div id="modalMessage"></div>
      <div class="modal-buttons">
        <button class="modal-btn" id="playAgainBtn">Play Again</button>
        <button class="modal-btn" id="quitBtn">Quit</button>
      </div>
    </div>
  </div>
  <script>
    // Retro Pong logic with local controls

    const canvas = document.getElementById('pong');
    const ctx = canvas.getContext('2d');

    // Paddle
    const paddleWidth = 12;
    const paddleHeight = 90;
    let player1Y = canvas.height / 2 - paddleHeight / 2;
    let player2Y = player1Y;

    // Ball
    const ballSize = 12;
    let ballX = canvas.width / 2;
    let ballY = canvas.height / 2;
    let ballSpeedX = (Math.random() > 0.5 ? 1 : -1) * 4;
    let ballSpeedY = (Math.random() > 0.5 ? 1 : -1) * 4;

    // Score
    let player1Score = 0;
    let player2Score = 0;
    let gameActive = true;

    // Controls
    let p1Up = false, p1Down = false, p2Up = false, p2Down = false;
    const moveSpeed = 8;

    // Modal Elements
    const modalOverlay = document.getElementById('modalOverlay');
    const modalMessage = document.getElementById('modalMessage');
    const playAgainBtn = document.getElementById('playAgainBtn');
    const quitBtn = document.getElementById('quitBtn');

    function showModal(winner) {
      modalMessage.textContent = `Game Over! ${winner} Wins!`;
      modalOverlay.style.display = 'flex';
      gameActive = false;
    }

    function hideModal() {
      modalOverlay.style.display = 'none';
      gameActive = true;
    }

    playAgainBtn.onclick = function() {
      player1Score = 0;
      player2Score = 0;
      updateScore();
      player1Y = canvas.height / 2 - paddleHeight / 2;
      player2Y = player1Y;
      hideModal();
      resetBall(1);
    };
    quitBtn.onclick = function() {
      window.close();
      // If window.close doesn't work (most browsers), reload the page and show quit message
      window.location.reload();
    };

    function drawRect(x, y, w, h, color) {
      ctx.fillStyle = color;
      ctx.fillRect(x, y, w, h);
    }
    function drawCircle(x, y, r, color) {
      ctx.fillStyle = color;
      ctx.beginPath();
      ctx.arc(x, y, r, 0, Math.PI * 2);
      ctx.closePath();
      ctx.fill();
    }
    function drawText(text, x, y, color = '#fff', size = 30) {
      ctx.fillStyle = color;
      ctx.font = `${size}px Courier New, monospace`;
      ctx.textAlign = 'center';
      ctx.fillText(text, x, y);
    }

    function resetBall(scoringPlayer) {
      ballX = canvas.width / 2;
      ballY = canvas.height / 2;
      ballSpeedX = (scoringPlayer === 1 ? -1 : 1) * 4;
      ballSpeedY = (Math.random() > 0.5 ? 1 : -1) * (4 + Math.random()*2);
    }

    function update() {
      if (!gameActive) return;
      // Move paddles
      if (p1Up) player1Y -= moveSpeed;
      if (p1Down) player1Y += moveSpeed;
      if (p2Up) player2Y -= moveSpeed;
      if (p2Down) player2Y += moveSpeed;
      // Clamp paddles
      player1Y = Math.max(0, Math.min(canvas.height - paddleHeight, player1Y));
      player2Y = Math.max(0, Math.min(canvas.height - paddleHeight, player2Y));

      // Ball movement
      ballX += ballSpeedX;
      ballY += ballSpeedY;

      // Top/bottom wall collision
      if (ballY <= 0 || ballY + ballSize >= canvas.height) {
        ballSpeedY = -ballSpeedY;
      }

      // Left paddle collision
      if (
        ballX <= paddleWidth &&
        ballY + ballSize > player1Y &&
        ballY < player1Y + paddleHeight
      ) {
        ballSpeedX = -ballSpeedX * 1.05;
        // Add a little randomness
        ballSpeedY += (Math.random()-0.5)*2;
        ballX = paddleWidth + 1;
      } else if (ballX < 0) {
        player2Score++;
        updateScore();
        resetBall(2);
      }

      // Right paddle collision
      if (
        ballX + ballSize >= canvas.width - paddleWidth &&
        ballY + ballSize > player2Y &&
        ballY < player2Y + paddleHeight
      ) {
        ballSpeedX = -ballSpeedX * 1.05;
        ballSpeedY += (Math.random()-0.5)*2;
        ballX = canvas.width - paddleWidth - ballSize - 1;
      } else if (ballX + ballSize > canvas.width) {
        player1Score++;
        updateScore();
        resetBall(1);
      }
    }

    function updateScore() {
      document.getElementById("score").innerHTML =
        `${player1Score} &nbsp; | &nbsp; ${player2Score}`;
      // Win condition
      if (player1Score >= 10 || player2Score >= 10) {
        setTimeout(() => {
          showModal(player1Score >= 10 ? "Player 1" : "Player 2");
        }, 100);
      }
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      drawRect(0, 0, canvas.width, canvas.height, '#000');
      // Middle dashed line
      for (let i = 0; i < canvas.height; i += 28) {
        drawRect(canvas.width / 2 - 2, i, 4, 18, '#fff');
      }
      // Paddles
      drawRect(0, player1Y, paddleWidth, paddleHeight, '#fff');
      drawRect(canvas.width - paddleWidth, player2Y, paddleWidth, paddleHeight, '#fff');
      // Ball
      drawCircle(ballX, ballY, ballSize / 2, '#fff');
      // Score HUD on canvas (in case you want extra retro)
      drawText(player1Score, canvas.width / 4, 55, '#fff', 48);
      drawText(player2Score, 3 * canvas.width / 4, 55, '#fff', 48);
    }

    function gameLoop() {
      update();
      draw();
    }
    setInterval(gameLoop, 1000 / 60);

    // Controls
    document.addEventListener("keydown", function (e) {
      if (!gameActive) return;
      if (e.key === "w" || e.key === "W") p1Up = true;
      if (e.key === "s" || e.key === "S") p1Down = true;
      if (e.key === "ArrowUp") p2Up = true;
      if (e.key === "ArrowDown") p2Down = true;
    });
    document.addEventListener("keyup", function (e) {
      if (e.key === "w" || e.key === "W") p1Up = false;
      if (e.key === "s" || e.key === "S") p1Down = false;
      if (e.key === "ArrowUp") p2Up = false;
      if (e.key === "ArrowDown") p2Down = false;
    });
  </script>
</body>
</html>